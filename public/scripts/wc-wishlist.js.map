{"version":3,"file":"/scripts/wc-wishlist.js","mappings":"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","sources":["webpack://sage/./resources/scripts/wc-wishlist.js"],"sourcesContent":["(function ($) {\r\n    document.addEventListener('filterProductsByOrder', wishlistInit)\r\n    document.addEventListener('filterProductsByPrice', wishlistInit)\r\n\r\n    \"use strict\";\r\n    let loadingAnimation = \"<span class='spinner-border'><div></div><div></div></span>\";\r\n    let wishlist_container = jQuery('.wishlist main .content');\r\n\r\n    Array.prototype.unique = function () {\r\n        return this.filter(function (value, index, self) {\r\n            return self.indexOf(value) === index;\r\n        });\r\n    }\r\n\r\n    function isInArray(value, array) {\r\n        return array.indexOf(value) > -1;\r\n    }\r\n\r\n    function onWishlistComplete(target, title) {\r\n        setTimeout(function () {\r\n            target\r\n                .removeClass('is-loading')\r\n                .attr('title', title);\r\n        }, 500);\r\n    }\r\n\r\n    function highlightWishlist(wishlistIds, title) {\r\n        jQuery('.wishlist-toggle').each(function () {\r\n            let $this = jQuery(this);\r\n            let currentProduct = $this.data('product');\r\n            currentProduct = currentProduct.toString();\r\n            if (isInArray(currentProduct, wishlistIds)) {\r\n                $this.addClass('is-active').attr('title', title);\r\n            }\r\n        });\r\n    }\r\n\r\n    let shopName = woocommerce_params_wishlist.shop_name + '-wishlist',\r\n        inWishlist = woocommerce_params_wishlist.in_wishlist_text,\r\n        restUrl = woocommerce_params_wishlist.rest_url,\r\n        wishlistIds = new Array,\r\n        ls = sessionStorage.getItem(shopName),\r\n        loggedIn = (jQuery('body').hasClass('logged-in')) ? true : false,\r\n        userData = '';\r\n\r\n    if (loggedIn) {\r\n        // Fetch current user data\r\n        fetchWishlistUserData();\r\n    } else {\r\n        if (typeof (ls) != 'undefined' && ls != null) {\r\n            ls = ls.split(',');\r\n            ls = ls.unique();\r\n            wishlistIds = ls;\r\n        }\r\n\r\n        if (wishlist_container.length > 0) {\r\n            fetchWishlistUserData();\r\n        } else {\r\n            wishlistInit();\r\n        }\r\n    }\r\n\r\n    function fetchWishlistUserData() {\r\n\r\n        wishlist_container.append(loadingAnimation);\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: woocommerce_params.ajax_url,\r\n            data: {\r\n                'action': 'fetch_user_data',\r\n                'dataType': 'json',\r\n                'wishlist_ids': wishlistIds\r\n            },\r\n            success: function (data) {\r\n                wishlist_container.find('.spinner-border').remove();\r\n\r\n                userData = JSON.parse(data);\r\n                wishlistIds = userData['wishlist_ids'];\r\n\r\n                if (wishlist_container.length > 0) {\r\n                    if (wishlist_container.find('.products').length === 0) {\r\n                        wishlist_container.hide().html(userData['wishlist']).fadeIn();\r\n                    } else {\r\n                        wishlist_container.html(userData['wishlist']);\r\n                    }\r\n                }\r\n\r\n                if (loggedIn) {\r\n                    sessionStorage.removeItem(shopName);\r\n                }\r\n\r\n                wishlistInit();\r\n\r\n            },\r\n            error: function () {\r\n            }\r\n        });\r\n    }\r\n\r\n    function wishListTrigger($this) {\r\n        $this.on('click', function (e) {\r\n            e.preventDefault();\r\n            if (!jQuery(this).hasClass('is-loading')) {\r\n                jQuery(this).addClass('is-loading');\r\n\r\n                if (jQuery(this).hasClass('is-active')) {\r\n                    jQuery(this).removeClass('is-active');\r\n\r\n                    if (jQuery('body').hasClass('wishlist')) {\r\n                        jQuery(this).closest('.product').fadeOut().promise().done(function () {\r\n                            jQuery(this).remove();\r\n                        });\r\n                    }\r\n\r\n                    for (let i = wishlistIds.length - 1; i >= 0; i--) {\r\n                        if (wishlistIds[i] == jQuery(this).data('product')) {\r\n                            wishlistIds.splice(i, 1);\r\n                        }\r\n                    }\r\n                } else {\r\n                    jQuery(this).addClass('is-active')\r\n                    wishlistIds.push(jQuery(this).data('product').toString());\r\n                }\r\n\r\n                wishlistIds = wishlistIds.unique().filter(function (v) {\r\n                    return v !== ''\r\n                });\r\n\r\n                if (wishlistIds.length === 0 && wishlist_container.length > 0) {\r\n                    wishlist_container.append(loadingAnimation);\r\n                }\r\n\r\n                jQuery('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n\r\n                if (loggedIn) {\r\n                    $.ajax({\r\n                        type: 'POST',\r\n                        url: woocommerce_params_wishlist.ajax_post,\r\n                        data: {\r\n                            action: 'user_wishlist_update',\r\n                            user_id: userData['user_id'],\r\n                            wishlist_ids: wishlistIds.join(','),\r\n                        }\r\n                    })\r\n                        .done(function (response) {\r\n                            if (wishlistIds.length === 0) {\r\n                                fetchWishlistUserData();\r\n                            }\r\n                        })\r\n                        .fail(function (data) {\r\n                            alert(woocommerce_params_wishlist.error_text);\r\n                        });\r\n                } else {\r\n                    sessionStorage.setItem(shopName, wishlistIds.toString());\r\n                    if (wishlistIds.length === 0) {\r\n                        fetchWishlistUserData();\r\n                    }\r\n                }\r\n\r\n                onWishlistComplete($this, inWishlist);\r\n            }\r\n        });\r\n    }\r\n\r\n    wishListTrigger(jQuery('.wishlist-toggle'));\r\n\r\n    function wishlistInit() {\r\n        wishlistIds = wishlistIds.filter(function (el) {\r\n            return el != \"\";\r\n        });\r\n        jQuery('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n        jQuery('.wishlist-toggle').each(function () {\r\n            let $this = jQuery(this);\r\n\r\n            if (!loggedIn) {\r\n                let currentProduct = $this.data('product');\r\n                currentProduct = currentProduct.toString();\r\n                if (!loggedIn && isInArray(currentProduct, wishlistIds)) {\r\n                    $this.addClass('is-active').attr('title', inWishlist);\r\n                }\r\n            }\r\n\r\n            wishListTrigger($this);\r\n        });\r\n    }\r\n\r\n    setTimeout(function () {\r\n\r\n        if (wishlistIds.length) {\r\n\r\n            restUrl += '?include=' + wishlistIds.join(',');\r\n            restUrl += '&per_page=' + wishlistIds.length;\r\n\r\n            $.ajax({\r\n                dataType: 'json',\r\n                url: restUrl\r\n            })\r\n                .done(function (response) {\r\n\r\n                })\r\n                .fail(function (response) {\r\n                    alert(woocommerce_params_wishlist.no_wishlist_text);\r\n                })\r\n        }\r\n\r\n    }, 1000);\r\n})(jQuery);\r\n"],"names":["$","document","addEventListener","wishlistInit","loadingAnimation","wishlist_container","jQuery","isInArray","value","array","indexOf","Array","prototype","unique","this","filter","index","self","shopName","woocommerce_params_wishlist","shop_name","inWishlist","in_wishlist_text","restUrl","rest_url","wishlistIds","ls","sessionStorage","getItem","loggedIn","hasClass","userData","fetchWishlistUserData","append","ajax","type","url","woocommerce_params","ajax_url","data","success","find","remove","JSON","parse","length","hide","html","fadeIn","removeItem","error","wishListTrigger","$this","on","e","preventDefault","addClass","removeClass","closest","fadeOut","promise","done","i","splice","push","toString","v","attr","ajax_post","action","user_id","wishlist_ids","join","response","fail","alert","error_text","setItem","target","title","setTimeout","el","each","currentProduct","split","dataType","no_wishlist_text"],"sourceRoot":""}