{"version":3,"file":"/scripts/wc-wishlist.js","mappings":"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","sources":["webpack://sage/./resources/scripts/wc-wishlist.js"],"sourcesContent":["(function ($) {\r\n    document.addEventListener('filterProducts', wishlistInit)\r\n    document.addEventListener('filterProductsByOrder', wishlistInit)\r\n    document.addEventListener('filterProductsByPrice', wishlistInit)\r\n\r\n    \"use strict\";\r\n    let loadingAnimation = \"<span class='spinner-border'><div></div><div></div></span>\";\r\n    let wishlist_container = jQuery('.wishlist main .content');\r\n\r\n    Array.prototype.unique = function () {\r\n        return this.filter(function (value, index, self) {\r\n            return self.indexOf(value) === index;\r\n        });\r\n    }\r\n\r\n    function isInArray(value, array) {\r\n        return array.indexOf(value) > -1;\r\n    }\r\n\r\n    function onWishlistComplete(target, title) {\r\n        setTimeout(function () {\r\n            target\r\n                .removeClass('is-loading')\r\n                .attr('title', title);\r\n        }, 500);\r\n    }\r\n\r\n    function highlightWishlist(wishlistIds, title) {\r\n        jQuery('.wishlist-toggle').each(function () {\r\n            let $this = jQuery(this);\r\n            let currentProduct = $this.data('product');\r\n            currentProduct = currentProduct.toString();\r\n            if (isInArray(currentProduct, wishlistIds)) {\r\n                $this.addClass('is-active').attr('title', title);\r\n            }\r\n        });\r\n    }\r\n\r\n    let shopName = growtype_wc_ajax.shop_name + '-wishlist',\r\n        inWishlist = growtype_wc_ajax.in_wishlist_text,\r\n        restUrl = growtype_wc_ajax.rest_url,\r\n        wishlistIds = new Array,\r\n        ls = sessionStorage.getItem(shopName),\r\n        loggedIn = (jQuery('body').hasClass('logged-in')) ? true : false,\r\n        userData = '';\r\n\r\n    if (loggedIn) {\r\n        // Fetch current user data\r\n        fetchWishlistUserData();\r\n    } else {\r\n        if (typeof (ls) != 'undefined' && ls != null) {\r\n            ls = ls.split(',');\r\n            ls = ls.unique();\r\n            wishlistIds = ls;\r\n        }\r\n\r\n        if (wishlist_container.length > 0) {\r\n            fetchWishlistUserData();\r\n        } else {\r\n            wishlistInit();\r\n        }\r\n    }\r\n\r\n    function fetchWishlistUserData() {\r\n\r\n        wishlist_container.append(loadingAnimation);\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: growtype_wc_ajax.url,\r\n            data: {\r\n                'action': 'fetch_user_data',\r\n                'dataType': 'json',\r\n                'wishlist_ids': wishlistIds\r\n            },\r\n            success: function (data) {\r\n                wishlist_container.find('.spinner-border').remove();\r\n\r\n                userData = JSON.parse(data);\r\n                wishlistIds = userData['wishlist_ids'];\r\n\r\n                if (wishlist_container.length > 0) {\r\n                    if (wishlist_container.find('.products').length === 0) {\r\n                        wishlist_container.hide().html(userData['wishlist']).fadeIn();\r\n                    } else {\r\n                        wishlist_container.html(userData['wishlist']);\r\n                    }\r\n                }\r\n\r\n                if (loggedIn) {\r\n                    sessionStorage.removeItem(shopName);\r\n                }\r\n\r\n                wishlistInit();\r\n\r\n            },\r\n            error: function () {\r\n            }\r\n        });\r\n    }\r\n\r\n    function wishListTrigger($this) {\r\n        $this.on('click', function (e) {\r\n            e.preventDefault();\r\n            if (!jQuery(this).hasClass('is-loading')) {\r\n                jQuery(this).addClass('is-loading');\r\n\r\n                if (jQuery(this).hasClass('is-active')) {\r\n                    jQuery(this).removeClass('is-active');\r\n\r\n                    if (jQuery('body').hasClass('wishlist')) {\r\n                        jQuery(this).closest('.product').fadeOut().promise().done(function () {\r\n                            jQuery(this).remove();\r\n                        });\r\n                    }\r\n\r\n                    for (let i = wishlistIds.length - 1; i >= 0; i--) {\r\n                        if (wishlistIds[i] == jQuery(this).data('product')) {\r\n                            wishlistIds.splice(i, 1);\r\n                        }\r\n                    }\r\n                } else {\r\n                    jQuery(this).addClass('is-active')\r\n                    wishlistIds.push(jQuery(this).data('product').toString());\r\n                }\r\n\r\n                wishlistIds = wishlistIds.unique().filter(function (v) {\r\n                    return v !== ''\r\n                });\r\n\r\n                if (wishlistIds.length === 0 && wishlist_container.length > 0) {\r\n                    wishlist_container.append(loadingAnimation);\r\n                }\r\n\r\n                jQuery('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n\r\n                if (loggedIn) {\r\n                    $.ajax({\r\n                        type: 'POST',\r\n                        url: growtype_wc_ajax.url,\r\n                        data: {\r\n                            action: 'user_wishlist_update',\r\n                            user_id: userData['user_id'],\r\n                            wishlist_ids: wishlistIds.join(','),\r\n                        }\r\n                    })\r\n                        .done(function (response) {\r\n                            if (wishlistIds.length === 0) {\r\n                                fetchWishlistUserData();\r\n                            }\r\n                        })\r\n                        .fail(function (data) {\r\n                            alert(growtype_wc_ajax.error_text);\r\n                        });\r\n                } else {\r\n                    sessionStorage.setItem(shopName, wishlistIds.toString());\r\n                    if (wishlistIds.length === 0) {\r\n                        fetchWishlistUserData();\r\n                    }\r\n                }\r\n\r\n                onWishlistComplete($this, inWishlist);\r\n            }\r\n        });\r\n    }\r\n\r\n    wishListTrigger(jQuery('.wishlist-toggle'));\r\n\r\n    function wishlistInit() {\r\n        wishlistIds = wishlistIds.filter(function (el) {\r\n            return el != \"\";\r\n        });\r\n        jQuery('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n        jQuery('.wishlist-toggle').each(function () {\r\n            let $this = jQuery(this);\r\n\r\n            if (!loggedIn) {\r\n                let currentProduct = $this.data('product');\r\n                currentProduct = currentProduct.toString();\r\n                if (!loggedIn && isInArray(currentProduct, wishlistIds)) {\r\n                    $this.addClass('is-active').attr('title', inWishlist);\r\n                }\r\n            }\r\n\r\n            wishListTrigger($this);\r\n        });\r\n    }\r\n\r\n    setTimeout(function () {\r\n\r\n        if (wishlistIds.length) {\r\n\r\n            restUrl += '?include=' + wishlistIds.join(',');\r\n            restUrl += '&per_page=' + wishlistIds.length;\r\n\r\n            $.ajax({\r\n                dataType: 'json',\r\n                url: restUrl\r\n            })\r\n                .done(function (response) {\r\n\r\n                })\r\n                .fail(function (response) {\r\n                    alert(growtype_wc_ajax.no_wishlist_text);\r\n                })\r\n        }\r\n\r\n    }, 1000);\r\n})(jQuery);\r\n"],"names":["$","document","addEventListener","wishlistInit","loadingAnimation","wishlist_container","jQuery","isInArray","value","array","indexOf","Array","prototype","unique","this","filter","index","self","shopName","growtype_wc_ajax","shop_name","inWishlist","in_wishlist_text","restUrl","rest_url","wishlistIds","ls","sessionStorage","getItem","loggedIn","hasClass","userData","fetchWishlistUserData","append","ajax","type","url","data","success","find","remove","JSON","parse","length","hide","html","fadeIn","removeItem","error","wishListTrigger","$this","on","e","preventDefault","addClass","removeClass","closest","fadeOut","promise","done","i","splice","push","toString","v","attr","action","user_id","wishlist_ids","join","response","fail","alert","error_text","setItem","target","title","setTimeout","el","each","currentProduct","split","dataType","no_wishlist_text"],"sourceRoot":""}